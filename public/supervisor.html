<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù (V5)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; background-color: #f3f4f6; }
        .badge { @apply px-2 py-1 rounded text-xs font-bold; }
        .badge-wait { @apply bg-yellow-100 text-yellow-700; }
        .badge-active { @apply bg-green-100 text-green-700; }
        .badge-done { @apply bg-gray-100 text-gray-700; }
    </style>
    <script src="js/i18n.js"></script>
    <script src="js/auth.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="p-4">
    <div class="absolute top-2 left-2 flex space-x-2 z-50">
        <button onclick="i18n.switchLanguage('ar')" class="px-2 py-1 bg-white border rounded shadow-sm text-xs font-medium hover:bg-gray-50">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        <button onclick="i18n.switchLanguage('en')" class="px-2 py-1 bg-white border rounded shadow-sm text-xs font-medium hover:bg-gray-50">En</button>
    </div>
    <header class="flex justify-between items-center mb-6 bg-white p-3 rounded shadow">
        <h1 data-i18n="supervisor_header" class="text-xl font-bold text-gray-800">ğŸ‘€Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù </h1>
        <div class="space-x-4 space-x-reverse">
            <!-- <a href="supervisor-receipts.html" class="bg-blue-100 text-blue-700 px-3 py-1 rounded font-bold hover:bg-blue-200 ml-2">ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª</a> -->
            <a href="#" onclick="auth.logout()" data-i18n="logout" class="text-red-500 font-bold text-sm bg-white border border-red-200 px-3 py-1 rounded hover:bg-red-50">Ø®Ø±ÙˆØ¬</a>
        </div>
    </header>

    <!-- Transfer Modal -->
    <div id="transferModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded shadow-lg w-96 relative">
            <button onclick="toggleTransferModal()" class="absolute top-2 left-2 text-gray-500 hover:text-red-500">âœ•</button>
            <h2 data-i18n="transfer_modal_title" class="text-xl font-bold mb-4">ğŸ” Ù†Ù‚Ù„/Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† (Transfer)</h2>
            <p data-i18n="transfer_modal_desc" class="text-sm text-gray-500 mb-4">Ù†Ù‚Ù„ Ø§Ù„Ø£Ù…ÙŠÙ† Ù„Ø±ØµÙŠÙ Ø¢Ø®Ø± Ø£Ùˆ Ø§Ù„Ø¹ÙƒØ³.</p>
            <form id="transferForm" class="space-y-4">
                <input type="hidden" id="transCompanyId">
                <div>
                    <label data-i18n="label_dock" class="block text-sm font-medium">1. Ø§Ø®ØªØ± Ø§Ù„Ø±ØµÙŠÙ</label>
                    <select id="transDockSelect" class="w-full p-2 border rounded" required></select>
                </div>
                <div>
                    <label data-i18n="label_sk" class="block text-sm font-medium">2. Ø§Ø®ØªØ± Ø£Ù…ÙŠÙ† Ø§Ù„Ù…Ø®Ø²Ù†</label>
                    <select id="transSkSelect" class="w-full p-2 border rounded" required></select>
                </div>
                <button type="submit" data-i18n="confirm_button" class="w-full bg-blue-600 text-white py-2 rounded font-bold hover:bg-blue-700">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</button>
            </form>
        </div>
    </div>

    <!-- Docks Section (Added) -->
    <div class="bg-white p-4 rounded shadow mb-4">
        <h2 data-i18n="docks_section_title" class="text-lg font-bold mb-4">ğŸš› Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø±ØµÙØ© (Docks)</h2>
        <div id="docksGrid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
            <!-- Loaded Dynamically -->
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
        
        <!-- Left Column: Storekeepers Status -->
        <div class="lg:col-span-1 bg-white p-4 rounded shadow h-[85vh] overflow-y-auto">
            <h2 data-i18n="sk_section_title" class="text-lg font-bold mb-4 border-b pb-2"> Ø§Ù„Ø£Ù…Ù†Ø§Ø¡ (Storekeepers)</h2>
            <div id="skList" class="space-y-2">
                <!-- Loaded Dynamically -->
            </div>
            <!-- No Save Button needed anymore -->
        </div>

        <!-- Right Column: Company Tracking -->
        <div class="lg:col-span-3 space-y-4">
            
            <!-- Active Jobs (Refactored to Active Receipts) -->
            <div class="bg-white p-4 rounded shadow">
                <div class="flex items-center mb-2">
                    <h2 data-i18n="active_receipts_title" class="text-lg font-bold">ğŸŸ¢ Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª Ø¬Ø§Ø±ÙŠØ© (Active Receipts)</h2>
                    <span id="inProgressCount" class="mr-2 bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-bold">0</span>
                </div>
                <div id="activeList" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <!-- Loaded Dynamically as Cards -->
                </div>
            </div>

            <!-- Removed Waiting Queue Section -->

            <!-- Recently Finished (Refactored to Completed Receipts) -->
            <div class="bg-white p-4 rounded shadow">
                    <div class="flex flex-col gap-3 mb-2">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <h2 data-i18n="history_title" class="text-lg font-bold">âœ… ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ (Recent History)</h2>
                                <span id="completedCount" class="mr-2 bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-bold">0</span>
                            </div>
                        </div>
                        
                        <!-- Filters Row -->
                        <div class="flex flex-col md:flex-row gap-2 items-center bg-gray-50 p-2 rounded border">
                            <div class="flex items-center gap-1 w-full md:w-auto">
                                <label data-i18n="label_from" class="text-xs font-bold text-gray-600">Ù…Ù†:</label>
                                <input type="date" id="dateFrom" onchange="filterHistory()" class="border rounded px-2 py-1 text-sm">
                            </div>
                            <div class="flex items-center gap-1 w-full md:w-auto">
                                <label data-i18n="label_to" class="text-xs font-bold text-gray-600">Ø¥Ù„Ù‰:</label>
                                <input type="date" id="dateTo" onchange="filterHistory()" class="border rounded px-2 py-1 text-sm">
                            </div>
                            <input type="text" id="historySearch" data-i18n="search_placeholder" onkeyup="filterHistory()" placeholder="ğŸ” Ø¨Ø­Ø« (Ø§Ù„Ø´Ø±ÙƒØ©ØŒ Ø§Ù„Ø£Ù…ÙŠÙ†ØŒ PO)..." class="border rounded px-2 py-1 text-sm flex-grow w-full md:w-auto">
                            <button onclick="exportToExcel()" data-i18n="export_excel" class="bg-green-600 text-white px-3 py-1 rounded text-sm font-bold hover:bg-green-700 whitespace-nowrap">ğŸ“¥ Export Excel</button>
                        </div>
                    </div>
                 <div id="historyList" class="space-y-2">
                     <!-- Loaded Dynamically as Cards/Rows -->
                </div>
            </div>

        </div>
    </div>


    <script src="./supervisor.js"></script>
</body>
</html>
